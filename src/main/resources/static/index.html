<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Classification Performance Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .header h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header .subtitle {
            text-align: center;
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(31, 38, 135, 0.5);
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .feature-toggles {
            grid-column: 1 / -1;
        }

        .toggle-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .toggle-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .toggle-item.active {
            border-color: #28a745;
            background: #d4edda;
        }

        .toggle-item.inactive {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            margin-bottom: 10px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .btn.success {
            background: linear-gradient(45deg, #27ae60, #229954);
        }

        .btn.warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }

        .btn.danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-indicator.excellent { background: #27ae60; }
        .status-indicator.good { background: #f39c12; }
        .status-indicator.fair { background: #e67e22; }
        .status-indicator.poor { background: #e74c3c; }

        .chain-of-thought {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
        }

        .chain-step {
            margin: 10px 0;
            padding: 10px;
            background: rgba(52, 73, 94, 0.5);
            border-radius: 5px;
            border-left: 3px solid #3498db;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .performance-chart {
            height: 300px;
            margin: 20px 0;
        }

        .log-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            color: #6c757d;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .toggle-grid {
                grid-template-columns: 1fr;
            }

            .metrics-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¨ Movie Classification Performance Dashboard</h1>
            <p class="subtitle">Real-time monitoring and optimization strategies</p>
        </div>

        <div class="card feature-toggles">
            <h3>üéõÔ∏è Feature Toggles & Strategy Selection</h3>
            <div class="toggle-grid">
                <div class="toggle-item" id="strategy-blocking">
                    <label class="toggle-switch">
                        <input type="radio" name="strategy" value="blocking" id="toggle-blocking">
                        <span class="slider"></span>
                    </label>
                    <div>
                        <strong>Blocking Strategy</strong>
                        <p>Original synchronous approach<br>
                        <small>~90+ seconds for 5 chunks</small></p>
                    </div>
                </div>

                <div class="toggle-item" id="strategy-optimized">
                    <label class="toggle-switch">
                        <input type="radio" name="strategy" value="optimized" id="toggle-optimized">
                        <span class="slider"></span>
                    </label>
                    <div>
                        <strong>Optimized Strategy</strong>
                        <p>Parallel processing + batching<br>
                        <small>~6-8 seconds for 5 chunks</small></p>
                    </div>
                </div>

                <div class="toggle-item" id="strategy-ultrafast">
                    <label class="toggle-switch">
                        <input type="radio" name="strategy" value="ultrafast" id="toggle-ultrafast" checked>
                        <span class="slider"></span>
                    </label>
                    <div>
                        <strong>Ultra-Fast Strategy</strong>
                        <p>Smart caching + optimization<br>
                        <small>~1-3 seconds for 5 chunks</small></p>
                    </div>
                </div>

                <div class="toggle-item" id="strategy-lightning">
                    <label class="toggle-switch">
                        <input type="radio" name="strategy" value="lightning" id="toggle-lightning">
                        <span class="slider"></span>
                    </label>
                    <div>
                        <strong>Lightning Strategy</strong>
                        <p>Full optimization suite<br>
                        <small>~0.5-1.5 seconds (with cache)</small></p>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn success" onclick="runSelectedStrategy()">üöÄ Run Processing</button>
                <button class="btn" onclick="loadMetrics()">üìä Refresh Metrics</button>
                <button class="btn warning" onclick="runPerformanceComparison()">‚ö° Compare All Strategies</button>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="card">
                <h3>üìà Real-time Metrics</h3>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="total-requests">-</div>
                        <div class="metric-label">Total Requests</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="cache-hit-rate">-</div>
                        <div class="metric-label">Cache Hit Rate</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="avg-response-time">-</div>
                        <div class="metric-label">Avg Response Time</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="tokens-processed">-</div>
                        <div class="metric-label">Tokens Processed</div>
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <h4>System Status</h4>
                    <p><span class="status-indicator excellent"></span><span id="system-status">Loading...</span></p>
                    <p><span class="status-indicator good"></span><span id="llm-status">Loading...</span></p>
                    <p><span class="status-indicator excellent"></span><span id="cache-status">Loading...</span></p>
                </div>
            </div>

            <div class="card">
                <h3>üí∞ Token Usage & Cost Analysis</h3>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="input-tokens">-</div>
                        <div class="metric-label">Input Tokens</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="output-tokens">-</div>
                        <div class="metric-label">Output Tokens</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="estimated-cost">-</div>
                        <div class="metric-label">Estimated Cost</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="cost-per-request">-</div>
                        <div class="metric-label">Cost per Request</div>
                    </div>
                </div>

                <canvas id="tokenChart" class="performance-chart"></canvas>
            </div>
        </div>

        <div class="card">
            <div class="tabs">
                <button class="tab active" onclick="showTab('processing')">üîÑ Processing Results</button>
                <button class="tab" onclick="showTab('chain-of-thought')">üß† Chain of Thought</button>
                <button class="tab" onclick="showTab('performance')">‚ö° Performance Analytics</button>
                <button class="tab" onclick="showTab('logs')">üìã System Logs</button>
            </div>

            <div id="tab-processing" class="tab-content active">
                <div id="processing-results">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Ready to process movies. Select a strategy and click "Run Processing".</p>
                    </div>
                </div>
            </div>

            <div id="tab-chain-of-thought" class="tab-content">
                <div class="chain-of-thought" id="chain-of-thought">
                    <div class="chain-step">
                        <strong>üé¨ System Initialization</strong><br>
                        Waiting for processing to begin...
                    </div>
                </div>
            </div>

            <div id="tab-performance" class="tab-content">
                <canvas id="performanceChart" class="performance-chart"></canvas>
                <div id="performance-comparison"></div>
            </div>

            <div id="tab-logs" class="tab-content">
                <div class="log-output" id="system-logs">
                    <div>[INFO] Dashboard initialized</div>
                    <div>[INFO] Waiting for user interaction...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin;
        let performanceChart = null;
        let tokenChart = null;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadMetrics();
            initializeCharts();
            setInterval(loadMetrics, 30000); // Refresh every 30 seconds

            // Initialize strategy selection
            updateStrategySelection();

            // Add event listeners for strategy changes
            document.querySelectorAll('input[name="strategy"]').forEach(radio => {
                radio.addEventListener('change', updateStrategySelection);
            });
        });

        function updateStrategySelection() {
            const selected = document.querySelector('input[name="strategy"]:checked').value;

            document.querySelectorAll('.toggle-item').forEach(item => {
                item.classList.remove('active', 'inactive');
                item.classList.add('inactive');
            });

            document.getElementById(`strategy-${selected}`).classList.remove('inactive');
            document.getElementById(`strategy-${selected}`).classList.add('active');

            addLog(`[INFO] Strategy selected: ${selected.toUpperCase()}`);
        }

        async function loadMetrics() {
            try {
                addLog('[INFO] Loading metrics...');

                // Load health and metrics
                const [healthResponse, metricsResponse, tokenResponse] = await Promise.all([
                    axios.get(`${API_BASE}/api/observability/health`),
                    axios.get(`${API_BASE}/api/observability/metrics`),
                    axios.get(`${API_BASE}/api/observability/tokens`)
                ]);

                updateDashboard(healthResponse.data, metricsResponse.data, tokenResponse.data);
                addLog('[SUCCESS] Metrics loaded successfully');

            } catch (error) {
                console.error('Error loading metrics:', error);
                addLog(`[ERROR] Failed to load metrics: ${error.message}`);
            }
        }

        function updateDashboard(health, metrics, tokens) {
            // Update basic metrics
            document.getElementById('total-requests').textContent = health.totalRequests || 0;
            document.getElementById('cache-hit-rate').textContent =
                health.cacheHitRate ? (health.cacheHitRate * 100).toFixed(1) + '%' : '0%';
            document.getElementById('avg-response-time').textContent =
                (health.avgProcessingTimeMs || 0) + 'ms';

            // Update token metrics
            if (tokens && tokens.totalProcessed) {
                document.getElementById('tokens-processed').textContent = tokens.totalProcessed.toLocaleString();
                document.getElementById('input-tokens').textContent = tokens.inputTotal.toLocaleString();
                document.getElementById('output-tokens').textContent = tokens.outputTotal.toLocaleString();
                document.getElementById('estimated-cost').textContent = tokens.costEstimation?.estimatedCostUSD || '$0.0000';

                const costPerRequest = health.totalRequests > 0 ?
                    (parseFloat(tokens.costEstimation?.estimatedCostUSD?.replace('$', '') || 0) / health.totalRequests).toFixed(6) : 0;
                document.getElementById('cost-per-request').textContent = '$' + costPerRequest;
            }

            // Update status indicators
            document.getElementById('system-status').textContent = `System: ${health.status || 'Unknown'}`;
            document.getElementById('llm-status').textContent = `LLM: ${health.llmStatus?.available ? 'Available' : 'Unavailable'}`;
            document.getElementById('cache-status').textContent = `Cache: ${health.cacheHitRate > 0.8 ? 'Excellent' : 'Good'}`;

            // Update charts
            updateTokenChart(tokens);
        }

        async function runSelectedStrategy() {
            const strategy = document.querySelector('input[name="strategy"]:checked').value;
            const resultsDiv = document.getElementById('processing-results');

            resultsDiv.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Running ${strategy.toUpperCase()} strategy...</p>
                </div>
            `;

            updateChainOfThought('üöÄ Processing Started', `Initializing ${strategy.toUpperCase()} strategy...`);
            addLog(`[INFO] Starting ${strategy.toUpperCase()} processing...`);

            try {
                let endpoint = '';
                switch(strategy) {
                    case 'blocking':
                        endpoint = '/api/movies/process?strategy=FIXED_SIZE&questionsPerChunk=2';
                        break;
                    case 'optimized':
                        endpoint = '/api/optimized/movies/process-fast?strategy=FIXED_SIZE&questionsPerChunk=2';
                        break;
                    case 'ultrafast':
                        endpoint = '/api/ultra-fast/movies/process-lightning?strategy=FIXED_SIZE&questionsPerChunk=2&maxChunks=5';
                        break;
                    case 'lightning':
                        endpoint = '/api/ultra-fast/movies/process-lightning?strategy=FIXED_SIZE&questionsPerChunk=2&maxChunks=5';
                        break;
                }

                const startTime = Date.now();
                updateChainOfThought('‚ö° API Call', `Making request to ${endpoint}`);

                const response = await axios.post(`${API_BASE}${endpoint}`);
                const endTime = Date.now();
                const duration = endTime - startTime;

                updateChainOfThought('‚úÖ Processing Complete',
                    `Strategy: ${strategy.toUpperCase()}\n` +
                    `Duration: ${duration}ms\n` +
                    `Chunks: ${response.data.chunksProcessed || 0}\n` +
                    `Questions: ${response.data.questionsGenerated || 0}\n` +
                    `Embeddings: ${response.data.embeddingsCreated || 0}`
                );

                displayResults(response.data, strategy, duration);
                addLog(`[SUCCESS] ${strategy.toUpperCase()} processing completed in ${duration}ms`);

                // Refresh metrics after processing
                setTimeout(loadMetrics, 1000);

            } catch (error) {
                console.error('Processing error:', error);
                resultsDiv.innerHTML = `
                    <div style="color: red; padding: 20px; text-align: center;">
                        <h4>‚ùå Processing Failed</h4>
                        <p>${error.message}</p>
                    </div>
                `;
                updateChainOfThought('‚ùå Error', `Processing failed: ${error.message}`);
                addLog(`[ERROR] Processing failed: ${error.message}`);
            }
        }

        function displayResults(data, strategy, duration) {
            const resultsDiv = document.getElementById('processing-results');

            const performanceImprovement = data.performanceImprovement || 'N/A';
            const cacheHitRate = data.cacheHitRate || '0.0%';

            resultsDiv.innerHTML = `
                <div style="background: #d4edda; padding: 20px; border-radius: 10px; border-left: 4px solid #28a745;">
                    <h4>‚úÖ Processing Completed Successfully</h4>
                    <div class="metrics-grid" style="margin-top: 15px;">
                        <div class="metric-card">
                            <div class="metric-value">${data.chunksProcessed || 0}</div>
                            <div class="metric-label">Chunks Processed</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${data.questionsGenerated || 0}</div>
                            <div class="metric-label">Questions Generated</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${data.embeddingsCreated || 0}</div>
                            <div class="metric-label">Embeddings Created</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">${duration}ms</div>
                            <div class="metric-label">Total Duration</div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <p><strong>Strategy:</strong> ${strategy.toUpperCase()}</p>
                        <p><strong>Performance:</strong> ${performanceImprovement}</p>
                        <p><strong>Cache Hit Rate:</strong> ${cacheHitRate}</p>
                        <p><strong>Throughput:</strong> ${data.throughput || 'N/A'}</p>
                    </div>

                    ${data.chunkResults ? `
                        <details style="margin-top: 15px;">
                            <summary><strong>Detailed Chunk Results</strong></summary>
                            <div style="margin-top: 10px; max-height: 200px; overflow-y: auto;">
                                ${data.chunkResults.map(chunk => `
                                    <div style="background: #f8f9fa; padding: 10px; margin: 5px 0; border-radius: 5px;">
                                        <strong>${chunk.chunkId}</strong> -
                                        ${chunk.questions} questions,
                                        ${chunk.embeddings} embeddings,
                                        ${chunk.timeMs}ms
                                    </div>
                                `).join('')}
                            </div>
                        </details>
                    ` : ''}
                </div>
            `;
        }

        function updateChainOfThought(step, details) {
            const chainDiv = document.getElementById('chain-of-thought');
            const timestamp = new Date().toLocaleTimeString();

            const stepDiv = document.createElement('div');
            stepDiv.className = 'chain-step';
            stepDiv.innerHTML = `
                <strong>[${timestamp}] ${step}</strong><br>
                <pre style="margin: 5px 0; white-space: pre-wrap;">${details}</pre>
            `;

            chainDiv.appendChild(stepDiv);
            chainDiv.scrollTop = chainDiv.scrollHeight;
        }

        function addLog(message) {
            const logsDiv = document.getElementById('system-logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            logsDiv.appendChild(logEntry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        async function runPerformanceComparison() {
            addLog('[INFO] Starting performance comparison...');
            updateChainOfThought('üèÅ Performance Comparison', 'Testing all strategies for comparison...');

            try {
                const response = await axios.get(`${API_BASE}/api/observability/performance`);
                displayPerformanceComparison(response.data);
                addLog('[SUCCESS] Performance comparison completed');
            } catch (error) {
                console.error('Performance comparison error:', error);
                addLog(`[ERROR] Performance comparison failed: ${error.message}`);
            }
        }

        function displayPerformanceComparison(data) {
            const comparisonDiv = document.getElementById('performance-comparison');

            comparisonDiv.innerHTML = `
                <h4>‚ö° Performance Strategy Comparison</h4>
                <div class="metrics-grid">
                    ${Object.entries(data.comparison || {}).map(([strategy, description]) => `
                        <div class="metric-card">
                            <div class="metric-value" style="font-size: 1.2em;">${strategy.toUpperCase()}</div>
                            <div class="metric-label">${description}</div>
                        </div>
                    `).join('')}
                </div>
            `;

            updateChainOfThought('üìä Comparison Results',
                Object.entries(data.comparison || {})
                    .map(([strategy, desc]) => `${strategy.toUpperCase()}: ${desc}`)
                    .join('\n')
            );
        }

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab content
            document.getElementById(`tab-${tabName}`).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function initializeCharts() {
            // Initialize token chart
            const tokenCtx = document.getElementById('tokenChart').getContext('2d');
            tokenChart = new Chart(tokenCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Input Tokens', 'Output Tokens'],
                    datasets: [{
                        data: [0, 0],
                        backgroundColor: ['#3498db', '#e74c3c'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: 'Token Usage Distribution'
                        }
                    }
                }
            });

            // Initialize performance chart
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(performanceCtx, {
                type: 'bar',
                data: {
                    labels: ['Blocking', 'Optimized', 'Ultra-Fast', 'Lightning'],
                    datasets: [{
                        label: 'Processing Time (seconds)',
                        data: [90, 7, 2, 0.5],
                        backgroundColor: ['#e74c3c', '#f39c12', '#3498db', '#27ae60'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Strategy Performance Comparison'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Time (seconds)'
                            }
                        }
                    }
                }
            });
        }

        function updateTokenChart(tokens) {
            if (tokenChart && tokens) {
                tokenChart.data.datasets[0].data = [
                    tokens.inputTotal || 0,
                    tokens.outputTotal || 0
                ];
                tokenChart.update();
            }
        }
    </script>
</body>
</html>
